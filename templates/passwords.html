<!DOCTYPE html>
<html>
<head>
    <title>Saved Passwords</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h2>Saved Passwords</h2>

    <!-- Search bar -->
    <input type="text" id="search" placeholder="Search site or username..." onkeyup="searchTable()">

    <table id="passwordTable">
        <tr>
            <th>Site</th>
            <th>Username</th>
            <th>Password</th>
            <th>Action</th>
        </tr>

        {% for p in passwords %}
        <tr>
            <td>{{ p.site }}</td>
            <td>{{ p.username }}</td>
            <td>
                <span id="pass{{ p.id }}">{{ p.password }}</span>
                <button onclick="copyPassword('pass{{ p.id }}')">Copy</button>
            </td>
            <td>
                <a class="delete-btn" href="/delete/{{ p.id }}">Delete</a>
            </td>
        </tr>
        {% endfor %}
    </table>

    <div class="bottom-buttons">
        <a href="/add" class="nav-btn">Add New Password</a>
    </div>
</div>

<script>
function copyPassword(id) {
    const text = document.getElementById(id).innerText;
    navigator.clipboard.writeText(text);
    alert("Password copied!");
}

function searchTable() {
    const input = document.getElementById("search");
    const filter = input.value.toLowerCase();
    const table = document.getElementById("passwordTable");
    const rows = table.getElementsByTagName("tr");

    for (let i = 1; i < rows.length; i++) {
        let site = rows[i].cells[0].innerText.toLowerCase();
        let user = rows[i].cells[1].innerText.toLowerCase();

        if (site.includes(filter) || user.includes(filter)) {
            rows[i].style.display = "";
        } else {
            rows[i].style.display = "none";
        }
    }
}
</script>
</body>
</html>
